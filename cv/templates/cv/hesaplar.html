{% extends 'cv/base.html' %}

{% block content %}
<div class="row mt-4">
  <!-- Sol Sütun: Yeni Hesap Ekleme Formu -->
  <div class="col-md-4">
    <h4>Yeni Hesap Ekle</h4>

    {% if form.errors %}
      <div class="alert alert-danger">
        <strong>Hata:</strong> Lütfen aşağıdaki alanları kontrol edin.
        <ul>
          {% for field in form %}
            {% for error in field.errors %}
              <li><strong>{{ field.label }}:</strong> {{ error }}</li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        {{ form.kod.label_tag }}
        {{ form.kod }}
      </div>
      <div class="mb-3">
        {{ form.ad.label_tag }}
        {{ form.ad }}
      </div>
      <div class="mb-3">
        {{ form.tur.label_tag }}
        {{ form.tur }}
      </div>
      <div class="mb-3">
        {{ form.ust_hesap.label_tag }}
        {{ form.ust_hesap }}
      </div>
      <button type="submit" class="btn btn-primary">Ekle</button>
    </form>
  </div>

  <!-- Sağ Sütun: Mevcut Hesaplar Tablosu -->
  <div class="col-md-8">
    <h2 class="mb-4">Muhasebe Hesap Planı</h2>
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>Kod</th>
          <th>Ad</th>
          <th>Tür</th>
          <th>Üst Hesap</th>
        </tr>
      </thead>
      <tbody>
        {% for hesap in hesaplar %}
        <tr>
          <td>{{ hesap.kod }}</td>
          <td>{{ hesap.ad }}</td>
          <td>
            {% if hesap.tur == 'aktif' %}
              <span class="badge bg-success">Aktif</span>
            {% elif hesap.tur == 'pasif' %}
              <span class="badge bg-secondary">Pasif</span>
            {% elif hesap.tur == 'gelir' %}
              <span class="badge bg-info text-dark">Gelir</span>
            {% elif hesap.tur == 'gider' %}
              <span class="badge bg-danger">Gider</span>
            {% elif hesap.tur == 'nazim' %}
              <span class="badge bg-warning text-dark">Nazım</span>
            {% else %}
              <span class="badge bg-light text-dark">Tanımsız</span>
            {% endif %}
          </td>
          <td>
            {% if hesap.ust_hesap %}
              <em>{{ hesap.ust_hesap.kod }} - {{ hesap.ust_hesap.ad }}</em>
            {% else %}
              <span class="text-muted">Yok</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4">Henüz hesap tanımlanmadı.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}